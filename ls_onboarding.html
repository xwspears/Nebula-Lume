<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>LS Onboarding – Rive Preview</title>
    <style>
      html, body { height: 100%; margin: 0; background: #000; }
      #wrap { height: 100%; display: grid; grid-template-rows: auto 1fr; }
      #status {
        font: 14px/1.4 system-ui, -apple-system, Segoe UI, Roboto, Arial;
        color: #fff; padding: 10px 12px;
        background: rgba(255,255,255,0.08);
      }
      canvas { width: 100%; height: 100%; display: block; }
    </style>
  </head>

  <body>
    <div id="wrap">
      <div id="status">Loading…</div>
      <canvas id="riveCanvas"></canvas>
    </div>

    <script type="module">
      const statusEl = document.getElementById("status");
      const setStatus = (msg) => { statusEl.textContent = msg; console.log(msg); };

      const RIV_PATH = "./ls_onboarding.riv"; // ✅ adjust if your file is in /assets

      // 1) Check the .riv file exists (this catches 404/path issues immediately)
      try {
        const res = await fetch(RIV_PATH, { cache: "no-store" });
        if (!res.ok) throw new Error(`Fetch failed: ${res.status} ${res.statusText}`);
        setStatus(`.riv found (${res.status}). Initializing Rive…`);
      } catch (e) {
        setStatus(`ERROR: Can't load ${RIV_PATH}. ${e.message}`);
        throw e;
      }

      // 2) Load Rive runtime and render
      try {
        const { default: Rive } = await import("https://unpkg.com/@rive-app/canvas@2.24.0");
        const rive = new Rive({
          src: RIV_PATH + "?v=" + Date.now(), // cache-bust
          canvas: document.getElementById("riveCanvas"),
          autoplay: true,
          // ✅ IMPORTANT: this must match your State Machine name EXACTLY
          stateMachines: "State_Machine_1",
          fit: "cover",
          alignment: "center",
          onLoad: () => {
            setStatus("Rive loaded ✅ (State machine: Main_Flow).");
            rive.resizeDrawingSurfaceToCanvas();
          },
        });

        window.addEventListener("resize", () => rive.resizeDrawingSurfaceToCanvas());
      } catch (e) {
        setStatus(`ERROR: Rive runtime/init failed. ${e.message}`);
        throw e;
      }
    </script>
  </body>
</html>

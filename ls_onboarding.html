<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Nebula-Lume â€“ LS Onboarding</title>

    <style>
      html, body {
        height: 100%;
        margin: 0;
        background: #000;
      }

      canvas {
        width: 100%;
        height: 100%;
        display: block;
      }

      #status {
        position: fixed;
        top: 10px;
        left: 10px;
        right: 10px;
        z-index: 9999;
        padding: 10px 12px;
        border-radius: 10px;
        background: rgba(255,255,255,0.12);
        color: #fff;
        font: 14px/1.35 system-ui, -apple-system, Segoe UI, Roboto, Arial;
        white-space: pre-wrap;
      }
    </style>
  </head>

  <body>
    <div id="status">Bootingâ€¦</div>
    <canvas id="riveCanvas"></canvas>

    <!-- âœ… REQUIRED: UMD runtime that exposes window.rive -->
    <script src="https://cdn.jsdelivr.net/npm/@rive-app/canvas@latest/rive.js"></script>

    <script>
      const statusEl = document.getElementById("status");
      const setStatus = (msg) => {
        statusEl.textContent = msg;
        console.log(msg);
      };

      // ðŸ”§ MUST MATCH YOUR REPO + FILE NAME EXACTLY
      const RIV_PATH = "./ls_onboarding.riv";

      // ðŸ”§ MUST MATCH STATE MACHINE NAME IN RIVE EXACTLY (SPACES + CASE)
      const STATE_MACHINE = "State Machine 1";

      (async function initRive() {

        // 1ï¸âƒ£ Confirm runtime loaded
        if (!window.rive || !window.rive.Rive) {
          setStatus("âŒ ERROR: Rive runtime failed to load (window.rive missing)");
          return;
        }

        // 2ï¸âƒ£ Confirm .riv file is reachable
        setStatus("Checking .riv fileâ€¦");
        try {
          const res = await fetch(RIV_PATH, { cache: "no-store" });
          if (!res.ok) {
            setStatus(
              `âŒ ERROR: Cannot load ${RIV_PATH}\n` +
              `HTTP ${res.status} ${res.statusText}\n\n` +
              `â€¢ File must be in the SAME folder as this HTML\n` +
              `â€¢ Filename & capitalization must match exactly`
            );
            return;
          }
        } catch (err) {
          setStatus("âŒ ERROR: Network error while fetching .riv\n" + err);
          return;
        }

        // 3ï¸âƒ£ Initialize Rive
        setStatus("Initializing Riveâ€¦");

        const r = new rive.Rive({
          src: RIV_PATH + "?v=" + Date.now(), // cache bust
          canvas: document.getElementById("riveCanvas"),
          autoplay: true,
          stateMachines: [STATE_MACHINE],
          fit: rive.Fit.Cover,
          alignment: rive.Alignment.Center,

          onLoad: () => {
            setStatus(
              "âœ… Rive loaded successfully\n" +
              "State Machine: " + STATE_MACHINE
            );
            r.resizeDrawingSurfaceToCanvas();
          },

          onLoadError: (err) => {
            setStatus("âŒ Rive load error:\n" + (err?.message || err));
          }
        });

        window.addEventListener("resize", () => {
          r.resizeDrawingSurfaceToCanvas();
        });

      })();
    </script>
  </body>
</html>
